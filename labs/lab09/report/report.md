---
## Front matter
title: "Отчёта по лабораторной работе №9"
subtitle: "Понятие подпрограммы. Отладчик GDB."
author: "Газизянов Владислав Альбертович"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Познакомиться с методами отладки при помощи GDB, его возможностями.

# Выполнение лабораторной работы

## Реализация подпрограмм в NASM
Создайте каталог для выполнения лабораторной работы № 9, перейдите в него и создайте файл lab09-1.asm:
<p align="center">![Создаём каталог](image/Снимок экрана от 2023-12-08 21-01-42.png){#fig:001 width=70%}</p>

В качестве примера рассмотрим программу вычисления арифметического выражения f(x) = 2x + 7 с помощью подпрограммы _calcul. В данном примере x вводится с клавиатуры, а само выражение вычисляется в подпрограмме. Внимательно изучите текст программы (Листинг 9.1).
Введите в файл lab09-1.asm текст программы из листинга 9.1. Создайте исполняемый файл и проверьте его работу.
<p align="center">![Заполняем файл](image/Снимок экрана от 2023-12-08 21-04-14.png){#fig:001 width=70%}</p>
<p align="center">![Проверяяем работу](image/Снимок экрана от 2023-12-08 21-06-00.png){#fig:001 width=70%}</p>
Измените текст программы, добавив подпрограмму _subcalcul в подпрограмму _calcul, для вычисления выражения f(g(x)), где x вводится с клавиатуры, f(x) = 2x + 7, g(x) = 3x − 1.
<p align="center">![Изменим текст программы](image/Снимок экрана от 2023-12-09 11-08-26.png){#fig:001 width=70%}</p>
Выодим результат.
<p align="center">![Результат](image/Снимок экрана от 2023-12-09 11-10-59.png){#fig:001 width=70%}</p>
## Отладка программам с помощью GDB

Создайте файл lab09-2.asm с текстом программы из Листинга 9.2.
<p align="center">![Создание файла](image/Снимок экрана от 2023-12-09 11-11-30.png){#fig:001 width=70%}</p>
<p align="center">![Заполнение](image/Снимок экрана от 2023-12-09 11-13-32.png){#fig:001 width=70%}</p>
Для работы с GDB в исполняемый файл необходимо добавить отладочную информацию, для этого трансляцию программ необходимо проводить с ключом ‘-g’.
<p align="center">![ключ -g](image/Снимок экрана от 2023-12-09 11-14-22.png){#fig:001 width=70%}</p>
Загрузите исполняемый файл в отладчик gdb
<p align="center">![Загрузка в gdb](image/Снимок экрана от 2023-12-09 11-15-13.png){#fig:001 width=70%}</p>
Проверьте работу программы, запустив ее в оболочке GDB с помощью команды run
<p align="center">![Проверка работы](image/Снимок экрана от 2023-12-09 11-15-46.png){#fig:001 width=70%}</p>
Для более подробного анализа программы установите брейкпоинт на метку _start, с которой начинается выполнение любой ассемблерной программы, и запустите её.
<p align="center">![брейкпоинт](image/Снимок экрана от 2023-12-09 11-16-32.png){#fig:001 width=70%}</p>
<p align="center">![Запуск](image/Снимок экрана от 2023-12-09 11-16-54.png){#fig:001 width=70%}</p>
Посмотрите дисассимилированный код программы с помощью команды disassemble начиная с метки _start
<p align="center">![Просмотрим код](image/Снимок экрана от 2023-12-09 11-18-07.png){#fig:001 width=70%}</p>
Переключитесь на отображение команд с Intel’овским синтаксисом, введя команду set disassembly-flavor intel
<p align="center">![переход на Intel](image/Снимок экрана от 2023-12-09 11-21-24.png){#fig:001 width=70%}</p>
<p align="center">![проверка работы](image/Снимок экрана от 2023-12-09 11-21-32.png){#fig:001 width=70%}</p>

Различия отображения синтаксиса машинных команд в режимах ATT и Intel:

1.Порядок операндов: В ATT синтаксисе порядок операндов обратный, сначала указывается исходный операнд, а затем - результирующий операнд. В Intel синтаксисе порядок обычно прямой, результирующий операнд указывается первым, а исходный - вторым.

2.Разделители: В ATT синтаксисе разделители операндов - запятые. В Intel синтаксисе разделители могут быть запятые или косые черты (/).

3.Префиксы размера операндов: В ATT синтаксисе размер операнда указывается перед операндом с использованием префиксов, таких как "b" (byte), "w" (word), "l" (long) и "q" (quadword). В Intel синтаксисе размер операнда указывается после операнда с использованием суффиксов, таких как "b", "w", "d" и "q".

4.Знак операндов: В ATT синтаксисе операнды с позитивными значениями предваряются символом "$". В Intel синтаксисе операнды с позитивными значениями могут быть указаны без символа "$".

5.Обозначение адресов: В ATT синтаксисе адреса указываются в круглых скобках. В Intel синтаксисе адреса указываются без скобок.

6.Обозначение регистров: В ATT синтаксисе обозначение регистра начинается с символа "%". В Intel синтаксисе обозначение регистра может начинаться с символа "R" или "E" (например, "%eax" или "RAX").

Включите режим псевдографики для более удобного анализа программы
<p align="center">![псевдографика](image/Снимок экрана от 2023-12-09 11-23-22.png){#fig:001 width=70%}</p>
## Добавление точек останова

Проверяем точки останова с помощью команды info breakpoints
<p align="center">![info breakpoints](image/Снимок экрана от 2023-12-09 11-25-45.png){#fig:001 width=70%}</p>
Установим еще одну точку останова по адресу инструкции
<p align="center">![точка останова](image/Снимок экрана от 2023-12-09 11-34-15.png){#fig:001 width=70%}</p>
Посмотрите информацию о всех установленных точках останова
<p align="center">![информация о точках](image/Снимок экрана от 2023-12-09 11-34-30.png){#fig:001 width=70%}</p>
## Работа с данными программы в GDB

Выполните 5 инструкций с помощью команды stepi (или si) и проследите за изменением значений регистров.
<p align="center">![инструкции](image/Снимок экрана от 2023-12-09 11-36-26.png){#fig:001 width=70%}</p>
Во время выполнения команд менялись регистры: ebx, ecx, edx,eax, eip.

Посмотреть содержимое регистров также можно с помощью команды info registers
<p align="center">![содержание регистров](image/Снимок экрана от 2023-12-09 11-36-50.png){#fig:001 width=70%}</p>
Посмотрите значение переменной msg1 по имени
<p align="center">![msg1](image/Снимок экрана от 2023-12-09 11-38-33.png){#fig:001 width=70%}</p>
Посмотрите значение переменной msg2 по адресу
<p align="center">![msg2](image/Снимок экрана от 2023-12-09 11-40-12.png){#fig:001 width=70%}</p>
Измените первый символ переменной msg1
<p align="center">![меняем символ](image/Снимок экрана от 2023-12-09 11-53-52.png){#fig:001 width=70%}</p>
Замените любой символ во второй переменной msg2
<p align="center">![меняеем символ](image/Снимок экрана от 2023-12-09 11-57-46.png){#fig:001 width=70%}</p>
Выведете в различных форматах значение регистра edx.
<p align="center">![значения](image/Снимок экрана от 2023-12-09 11-58-59.png){#fig:001 width=70%}</p>
<p align="center">![значения](image/Снимок экрана от 2023-12-09 12-00-10.png){#fig:001 width=70%}</p>
Выводится разные значения, так как команда без кавычек присваивает регистру вводимое значение.

Завершите выполнение программы с помощью команды continue
<p align="center">![завершение](image/Снимок экрана от 2023-12-09 12-01-05.png){#fig:001 width=70%}</p>
## Обработка аргументов командной строки в GDB

Создаём файл.
<p align="center">![создание файла](image/Снимок экрана от 2023-12-09 12-05-11.png){#fig:001 width=70%}</p>
Скопируйте файл lab8-2.asm, созданный при выполнении лабораторной работы №8, с программой выводящей на экран аргументы командной строки (Листинг 8.2) в файл с именем lab09-3.asm
<p align="center">![заполнение файла](image/Снимок экрана от 2023-12-09 12-06-36.png){#fig:001 width=70%}</p>
Создайте исполняемый файл
<p align="center">![исполняеемый файл](image/Снимок экрана от 2023-12-09 12-07-46.png){#fig:001 width=70%}</p>
Загрузите исполняемый файл в отладчик, указав аргументы:
<p align="center">![загрузка в отладчик](image/Снимок экрана от 2023-12-09 12-08-32.png){#fig:001 width=70%}</p>
установим точку останова перед первой инструкцией в программе и запустим ее.
<p align="center">![точка останова](image/Снимок экрана от 2023-12-09 12-09-28.png){#fig:001 width=70%}</p>
Посмотрите остальные позиции стека
<p align="center">![позиции стека](image/Снимок экрана от 2023-12-09 12-09-59.png){#fig:001 width=70%}</p>
<p align="center">![позиции стека](image/Снимок экрана от 2023-12-09 12-14-22.png){#fig:001 width=70%}</p>
Шаг изменения адреса равен 4 потому что адресные регистры имеют размерность 32 бита(4 байта).

## Задание для самостоятельной работы

### Задание 1
Копируем файл lab8-4.asm(ср №1 в ЛБ8) в файл с именем lab09-4.asm
<p align="center">![Копируем](image/Снимок экрана от 2023-12-09 13-40-00.png){#fig:001 width=70%}</p>
Открываем файл и меняем его, создавая подпрограмму
<p align="center">![Редатируем](image/Снимок экрана от 2023-12-09 15-15-55.png){#fig:001 width=70%}</p>
Создаем исполняемый файл и запускаем его
<p align="center">![Запуск](image/Снимок экрана от 2023-12-09 15-17-10.png){#fig:001 width=70%}</p>

### Задание 2
Создаём файл и всталвяем текст из листинг 9.3
<p align="center">![Новый файл](image/Снимок экрана от 2023-12-09 15-46-02.png){#fig:001 width=70%}</p>
Создаем исполняемый файл и запускаем его
<p align="center">![Запуск](image/Снимок экрана от 2023-12-09 15-22-43.png){#fig:001 width=70%}</p>
Создаем исполняемый файл и запускаем его в отладчике GDB и смотрим на изменение регистров командой si
<p align="center">![Смотрим изменения](image/Снимок экрана от 2023-12-09 15-39-53.png){#fig:001 width=70%}</p>
Изменяем программу для корректной работы
<p align="center">![корректируем](image/Снимок экрана от 2023-12-09 15-42-24.png){#fig:001 width=70%}</p>
Создаем исполняемый файл и запускаем его
<p align="center">![проверка работы](image/Снимок экрана от 2023-12-09 15-44-03.png){#fig:001 width=70%}</p>

# Выводы
Мы познакомились с методами отладки при помощи GDB и его возможностями.

